# -----------------------------------------------------------------------
# © Copyright 2003-2006 by Alex Peeters [alex.peeters@citap.be]
# -----------------------------------------------------------------------

# General - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Author       : Alex Peeters [alex.peeters@citap.be]
Latest update: xx xxx 2006
Version      : 3.000.012


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Version 3.000.012, 2006/xx/xx, Central and Distributed support
                               - added common variable TYPEMONITORING to Asnmtap.cnf
                               fixRights.sh
                               - updated: script om rechten (chmod en chown) te zetten
                               Makefile.PL
                               - version update CPAN 1.8802 & CPANPLUS 0.076
                               - version update ExtUtils::MakeMaker 6.31
                               - version update Module::AutoInstall 1.03
                               - version update Bundle::DBI 1.53
                               - version update CGI 3.25
                               - version update Compress::Zlib 2.001
                               - version update Config::General 2.31
                               - version update Config::General::Interpolated 2.07
                               - version update Crypt::OpenSSL::RSA 0.24
                               - version update Cwd 3.23
                               - version update Data::Dumper 2.121
                               - version update DateTime 0.35
                               - version update DateTime::Format::W3CDTF 0.04
                               - version update Device::Modem 1.47
                               - version update Digest::MD5 2.36
                               - version update Email::Simple 1.995
                               - version update Getopt::Long 2.35
                               - version update IO 1.23
                               - NEW IO::Socket::SSL 1.01
                               - version update MIME::Tools 5.420
                               - version update NetAddr::IP 4.004
                               - version update Net::FTP 2.75
                               - version update Net::Ifconfig::Wrapper 0.09
                               - NEW Net::SSLeay 1.30
                               - version update Proc::ProcessTable 0.41
                               - version update Sys::Hostname::Long 1.4
                               - NEW Test::Pod::Coverage 1.08
                               - version update Test::Simple 0.47
                               - version update Time::HiRes 1.94
                               - version update Time::Local 1.13
                               - version update XML::LibXML 1.61
                               - version update XML::Simple 2.16
                               - install 'ASNMTAP' with make install
                                 PM - This hash will contain a list of all ASNMTAP files
                               MANIFEST.SKIP
                               - A file full of regular expressions to exclude when using 'make manifest' to generate the MANIFEST.
                               - used by 'make manifest' to build the file MANIFEST
                               - also used by 'make skipcheck' & 'make distcheck'
                               Shared PERL & SSL support
                               - added environment variable PERL5LIB, MANPATH & LD_LIBRARY_PATH to Asnmtap.cnf
                               Windows Internet Explorer 7.0
                               - tested and did look OK
                               ASNMTAP::Asnmtap
                               - replace `::VERSION = 3.000.xxx` with `::VERSION = do { my @r = (q$Revision: 3.000.012$ =~ /\d+/g); sprintf "%d."."%03d" x $#r, @r };`
                               - replace `my $version = '3.000.xxx'` with `my $version = do { my @r = (q$Revision: 3.000.012$ =~ /\d+/g); sprintf "%d."."%03d" x $#r, @r };`
                               ASNMTAP::Asnmtap::Applications
                               - NEW purge_table.pl
                               - add Environment after the Plugin Titles
                               - add our %ENVIRONMENT = ('P'=>'Production', 'S'=>'Simulation', 'A'=>'Acceptation', 'T'=>'Test', 'D'=>'Development', 'L'=>'Local');
                               - used into display.pl, comments.pl, contact.pl, getHelpPlugin.pl, info.pl, perfparse.pl, runCmdOnDemand.pl & users.pl
                               - Applications.pod updated regarding 'perl Makefile.PL INSTALL_BASE=/opt/asnmtap/cpan-shared'
                               ASNMTAP::Asnmtap::Plugins
                               - Bugfix: replace: _programGetOptions  => [..., 'password|passwd|p=s', ...],
                                         with   : _programGetOptions  => [..., 'password|p|passwd=s', ...],
                               - Bugfix: replace: push ( @{ $_[0]->{_programGetOptions} }, 'status|S:s', 'asnmtapEnv|A:s', 'onDemand|O:s', 'logging|L:s', 'debugfile|dumphttp|httpdump|D:s', 'debug|d:s' );
                                         with   : push ( @{ $_[0]->{_programGetOptions} }, 'status|S:s', 'asnmtapEnv|A:s', 'onDemand|O:s', 'logging|L:s', 'debugfile|D|dumphttp|httpdump:s', 'debug|d:s' );
                               - check_memory-top.pl, now also Solaris 10 compatible
                               - Bugfix: '<environment>PROD</environment>' into check_template-mail-xml.pl & check_template-mail-xml-fingerprint-xml.pl
                               - replaced 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; ASNMTAP; U;' with 'Mozilla/4.7 (compatible; ASNMTAP; U;'
                               - NEW $ENV{HTTPS_VERSION} for v2, v3 and v23
                               ASNMTAP::Asnmtap::Plugins::Nagios
                               - NEW check_nagios-comments-cleanup.pl
                               - NEW EPN (Embedded Perl Nagios) compatible
                               ASNMTAP::Asnmtap::Plugins::NPTest
                               - upgrade van version NPTest v1.11 to v1.13
                               - replace NPTest->testCmd with ASNMTAP::Asnmtap::Plugins::NPTest->testCmd
                               ASNMTAP::Asnmtap::Plugins::SOAP
                               - add $SOAP::Constants::PATCH_HTTP_KEEPALIVE
                               - add ws-security through WSRF::Lite
                               ASNMTAP::Asnmtap::Plugins::WebTransact
                               - based on 'Nagios::WebTransact' v0.14.1 & v0.16 from Stanley Hopcroft [Stanley.Hopcroft@IPAustralia.Gov.AU]
             ATTENTION   -->   asnmtap-3.000.012.sql
                               - NEW table `environment`
                               - add `userPassword` varchar(15) NOT NULL default '' at table reports
                               - remove `reportTitle` varchar(100) NOT NULL default '' from table reports
                               - add `downtimeScheduling` tinyint(1) NOT NULL default '1' and `generatedReports` tinyint(1) NOT NULL default '0' at table users
                               Bugfix Popup Calendar
                               - replace document.forms[0].endDate with document.forms[1].endDate
                               collector.pl
                               - add automatically the environment at the end off the title
                               collector.pl & display.pl
                               - update atime and mtime from the PID file every timeslot
                               - email message for started, stopped & reloaded
                               collectorCrontabSchedulingReports.pl & collectorDaemonSchedulingReports.pl
                               - show only the Plugins regarding correspondending server
                               comments.pl & holidayBundleSetDowntimes.pl
                               - Sending email for: Downtime Scheduling
                               detailedStatisticsReportGenerationAndCompareResponsetimeTrends.pl
                               - Problem details: link to the correspondending 'Debug Report' when 'Format Output' equals 'HTML'
                               detailedStatisticsReportGenerationAndCompareResponsetimeTrends.pl, generateChart.pl & trendlineCorrectionReports.pl
                               - replace round(avg(duration), 2) with round(avg(time_to_sec(duration)), 2) because of wrong averages
                               display.pl
                               - possibility for sound on/off
                               - onderdrukking ledige groepen in full view
                               - vermelden op welke probe een test wordt uitgevoerd
                               - onderdrukken niet persistent downtimes in condenced view
                               - mask password for '--dnPass=', used by check_template-ldap.pl
                               - environment icons, exclaim popup window for plugins and comments
                               - 'In Progress'-animated icon replaced with 'In Progress'-static icon for faster display!
                               - de debugrapporten onderaan de view enkel aanklikbaar maken als de file via rsync al aanwezig is op het moment van de display generatie, ter voorkoming van 404 errors.
                               - add console messages: 'No Monitored Applications', 'All Monitored Applications are OK', '..., probably collector/config problems!' & , '..., probably database problems!'
                               displayDaemons.pl
                               - add 'ServerID' into general view
                               detailedStatisticsReportGenerationAndCompareResponsetimeTrends.pl
                               - add a checkbox, to choose output destination: HTML/PDF 
                               getArchivedReport.pl & getArchivedResults.pl
                               - YYYY/MM/DD notatie met voorloopnullen voor maand en dag
                               generateConfig.pl
                               - check for 'help plugin filenames' without plugin reference
                               - check for plugins without or with missing 'help plugin filename'
                               - looking after existing plugins that are not defined into the database plugins
                               - verify that the defined plugins into the table plugins, exists and are executable
                               - generate automatic the Rsync Mirror Distributed & Failover Scripts / Collector Daemon
                               generateReports.pl
             ATTENTION   -->   - tested with HTMLDOC v1.8.27 and added --user-password password support
                               - een plugin die disabled is waarvoor een rapport gevraagd wordt niet uitvoeren
                               - specify F for --daysAfter means that the specified date will be used as the reportdate
                               generateReports.pl & generateCollectorDaemonSchedulingReports.pl
                               - ... already generated / will be generated
                               - ... generated / generation failed
                               generatedReports.pl, plugins & reports.pl
                               - remove 'reportTitle'
                               get_ArchivedReport.pl & get_ArchivedResults.pl
                               - replace 'Week #' with 'Week # from monday off week until sunday off week'
                               plugins.pl
                               - upload for Help Plugin Filename (PDF)
                               - controle op '{}' bij ingeven van de value voor het veld 'Title:'
                               pluginCrontabSchedulingReports.pl
                               - show only the Plugins regarding correspondending server
                               removeModulePerl.pl
                               - NEW
                               rsync-mirror-*.sh
                               - replace: rsync -e "ssh -i $KeyRsync" -a $Delete $AdditionalParams $Source $Target
                                 with: ssh=<sshpath>; $Rsync -e "$ssh -i $KeyRsync" -a $Delete $AdditionalParams $Source $Target
                               runCmdOnDemand.pl
                               - mask password for '--dnPass=', used by check_template-ldap.pl
                               runStatusOnDemand.pl
                               - bugfix: 'Command: not found.' must be 'No Display|Collector daemons defined'
                               trendlineCorrectionReports.pl
                               - show only the Plugins regarding correspondending server and order by Title
                               user.pl
                               - Sending email for: Downtime Scheduling & Generated Reports


# INSTALLATION  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

To install this module type the following:

   perl Makefile.PL
   make
   make test
   make install

OR

When ypu need a proxyserver, and your CPAN and/or CPANPLUS isn't confugured
to use one, then you must set: HTTP_PROXY and/or FTP_PROXY

  export HTTP_PROXY="http://host:port"
  export FTP_PROXY="http://host:port"

perl -MCPAN -e 'install ASNMTAP::Asnmtap'
   

# BINARIES  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Cygwin:

  General:
  - Devel, expat v1.95.8

  Needed for Win32::API used by ASNMTAP::Asnmtap::Plugins::Modem
  - Libs, w32api v 3.6-1

  Needed for XML::LibXML used by ASNMTAP::Asnmtap::Plugins::XML
  - Libs, libxml2 v 2.6.22
  - Devel, libxml2 v 2.6.22


Linux:

  General:
  - yum install expat
  - yum install expat-devel

  Needed for XML::LibXML used by ASNMTAP::Asnmtap::Plugins::XML
  - yum install lib2xml
  - yum install lib2xml-devel


Solaris:

  General:
  - wget ftp://sunfreeware.com/pub/freeware/sparc/9/expat-1.95.5-sol9-sparc-local.gz
  - gzip -d expat-1.95.5-sol9-sparc-local.gz
  - pkgadd -d expat-1.95.5-sol9-sparc-local
  or
  - wget ftp://sunfreeware.com/pub/freeware/sparc/10/expat-1.95.5-sol10-sparc-local.gz
  - gzip -d expat-1.95.5-sol10-sparc-local.gz
  - pkgadd -d expat-1.95.5-sol10-sparc-local

  Needed for XML::LibXML used by ASNMTAP::Asnmtap::Plugins::XML
  - wget ftp://sunfreeware.com/pub/freeware/sparc/9/libxml2-2.6.16-sol9-sparc-local.gz
  - gzip -d libxml2-2.6.16-sol9-sparc-local.gz
  - pkgadd -d libxml2-2.6.16-sol9-sparc-local
  or
  - wget ftp://sunfreeware.com/pub/freeware/sparc/10/libxml2-2.6.16-sol10-sparc-local.gz
  - gzip -d libxml2-2.6.16-sol10-sparc-local.gz
  - pkgadd -d libxml2-2.6.16-sol10-sparc-local


# DEPENDENCIES  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

This module requires these other modules and libraries:

Base package ASNMTAP::Asnmtap
- Config::General:               2.30
- Config::General::Interpolated: 2.06
- Data::Dumper:                  2.12
- Dumpvalue:                     1.11
- Getopt::Long:                  2.32
- IO::CaptureOutput:             1.03
- Test::Simple:                  0.65
- Time::Local:                   1.04

ASNMTAP::Time
- Date::Calc:                    5.4
- Time::Local:                   1.04

ASNMTAP::Asnmtap::Applications
- ASNMTAP::Time:
- ASNMTAP::Asnmtap:
- Carp:
- Config::General:               2.30
- Config::General::Interpolated: 2.06
- Getopt::Long:                  2.32
- HTML::Entities:                1.29
- Mail::Sendmail:                0.79
- Time::Local:                   1.04

ASNMTAP::Asnmtap::Applications::CGI
- ASNMTAP::Time:
- ASNMTAP::Asnmtap::Applications:
- Carp:
- CGI::Session:                  4.13
- Date::Calc:                    5.4
- NetAddr::IP:                   3.028
- Proc::ProcessTable:            0.39
- Time::Local:                   1.04

ASNMTAP::Asnmtap::Applications::Collector
- ASNMTAP::Asnmtap::Applications:
- Carp:
- Time::Local:                   1.04

ASNMTAP::Asnmtap::Applications::Display
- ASNMTAP::Asnmtap::Applications:
- Carp:
- Time::Local:
 
ASNMTAP::Asnmtap::Plugins
- ASNMTAP::Asnmtap:
- Time::HiRes:                   1.66

ASNMTAP::Asnmtap::Plugins::IO
- ASNMTAP::Asnmtap::Plugins:
- IO:                            1.20

ASNMTAP::Asnmtap::Plugins::Nagios
- ASNMTAP::Asnmtap::Plugins:
- Time::Local:                   1.04

  check_template-ldap.pl
  - Net::LDAP:

    Dependencies Net::LDAP:
    - Convert::ASN1   - required
    - URI::ldap       - optional, needed for URL parsing
    - Digest::MD5     - optional, needed for SASL CRAM-MD5 auth
    - Net::SSLeay     - optional, needed for IO::Socket::SSL
                        needed OpenSSL-0.9.7b or newer...
    - IO::Socket::SSL - optional, needed for Net::LDAPS
    - XML::Parser     - optional, needed for Net::LDAP::DSML

ASNMTAP::Asnmtap::Plugins::Mail
- Date::Calc:                    5.4
- Email::Simple:                 1.92
- Mail::POP3Client               2.17
- Mail::Sendmail:                0.79
- MIME::Base64:                  3.01
- MIME::Parser                   5.419
- Net::IMAP::Simple:             1.14
- Net::POP3:                     2.28
- Time::Local:                   1.04

ASNMTAP::Asnmtap::Plugins::Modem
- ASNMTAP::Asnmtap::Plugins:

ASNMTAP::Asnmtap::Plugins::SOAP
- ASNMTAP::Asnmtap::Plugins:
- SOAP::Lite:

  Dependencies SOAP::Lite:
  - libwww-perl:
  - MIME::Base64:
  - URI:
  - WSRF::Lite:
  - XML::Parser:

  Dependencies WSRF::Lite:
  - DateTime:
  - DateTime::Format::Epoch:
  - DateTime::Format::W3CDTF:
  - Digest::SHA1:
  - Crypt::OpenSSL::RSA:
  - Crypt::OpenSSL::X509:
  - HTTP::Daemon::SSL:
  - MIME::Base64:
  - Sys::Hostname::Long:
  - XML::CanonicalizeXML:
  - XML::DOM:

  Following modules will be loaded on demand only, and are considered optional:
  - Crypt::SSLeay     HTTPS/SSL support
  - Apache            mod_perl server implementation (included with mod_perl)
  - Net::POP3         POP3 server implementation
  - MIME::Lite        SMTP client implementation
  - IO::File          FTP client and IO server
  - Net::FTP          FTP client
  - MQSeries          MQSeries transport
  - Net::Jabber       Jabber transport
  - FCGI              FastCGI server implementation
  - IO::Socket::SSL   SSL support for TCP transport
  - MIME::Tools       MIME attachment support
  - DIME::Tools       DIME attachment support
  - Compress::Zlib    HTTP compression support

ASNMTAP::Asnmtap::Plugins::WebTransact
- ASNMTAP::Asnmtap::Plugins:
- Bundle::LWP:                   1.11
- CGI:                           3.10
- Compress::Zlib:                1.41
- Digest::MD5:                   2.33
- Crypt::SSLeay:                 0.51
- MIME::Base64:                  3.01
- Net::FTP:                      2.58
- URI:                           1.35

ASNMTAP::Asnmtap::Plugins::XML
- ASNMTAP::Asnmtap::Plugins:
- XML::Parser:                   2.34
- XML::LibXML:                   1.58
- XML::Simple:                   2.14

ASNMTAP::Asnmtap::Plugins::NPTest
- Cwd:                           3.05
- Data::Dumper:                  2.12
- File::Basename:                2.73


HOWTO:

1) How can i unbless a data structure:

use Data::Structure::Util qw(unbless);
unbless($WSListResults);

Dependencies Data::Structure::Util
- Clone
- File::Find::Rule
- Test::Builder::Tester
- Test::Pod


# COPYRIGHT AND LICENCE - - - - - - - - - - - - - - - - - - - - - - - - -

COPYRIGHT
© Copyright 2000-2006 by Alex Peeters [alex.peeters@citap.com]

Version 3.000.004, 2006/02/12, ASNMTAP CPAN module ASNMTAP::Asnmtap::Plugins::Mail and  ASNMTAP::Asnmtap::Plugins::Modem

Version 3.000.003, 2006/02/03, ASNMTAP CPAN module

Version 3.000.002, 2006/01/08, ASNMTAP Package Object Oriented Perl

Version 3.000.001, 2006/01/01, ASNMTAP Package

'ASNMTAP' is based on 'Process System daemons v1.60.17-01' written by Alex Peeters [alex.peeters@citap.com]
'collector.pl' is based on 'Process System daemons v1.60.17-01' written by Alex Peeters [alex.peeters@citap.com]

Purpose: CronTab (CT, sysdCT),
         Disk Filesystem monitoring (DF, sysdDF),
         Intrusion Detection for FW-1 (ID, sysdID)
         Process System daemons (PS, sysdPS),
         Reachability of Remote Hosts on a network (RH, sysdRH),
         Rotate Logfiles (system activity files) (RL),
         Remote Socket monitoring (RS, sysdRS),
         System Activity monitoring (SA, sysdSA).

         sysdCT : (1.60.1.13) <minute (0-59)> <hour (0-23)> <day of the month (1-31)> <month of the year (1-12)> <day of the week (0-6 with 0=Sunday)> DF|ID|PS|RH|RL|RS|SA

         sysdDF : (1.60.1.2)  filesystem:percent:[optional stop action]:[optional start action]:support team email

         sysdID : (1.60.1.14) ... preparations ...

         sysdPS : (1.60.1.1)  process:comment:[optional stop action]:[optional start action]:support team email

         sysdRH : (1.60.1.9)  hostname:ip-adres:gateway:[protocol]:[timeout]:[bytes]:[optional stop action]:[optional start action]:support team email
                                                       icmp|tcp|udp   >= 0   <= 1024
         sysdRS : (1.60.1.15) protocol:ip-adres:port:service:[request]:[timeout]:[status]:[optional stop action]:[optional start action]:support team email
                               tcp|udp                                    >= 0
         sysdSA : (1.60.1.11) process:activity:comment:priority:facility:logfile:[optional stop action]:[optional start action]:support team email

         2002/03/02 - 2003/03/01, from v1.60.16.x until v1.60.17-01

         2002/01/03 - 2002/02/26, from v1.60.14.x until v1.60.15.x

         2001/12/26 - 2002/01/02, from v1.60.13.x until v1.60.14.x

         2000/10/19 - 2001/12/24, from v1.60.1.x until v1.60.13.x

'Process System daemons' is based on 'sysdaemon 1.60' written by Trans-Euro I.T Ltd

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

COPYRIGHT
© Copyright 2003-2006 by Alex Peeters [alex.peeters@citap.com]

ASNMTAP::Asnmtap::Plugins::WebTransact is based on 'Nagios::WebTransact', v0.14.1, Stanley.Hopcroft@IPAustralia.Gov.AU

Version 3.000.004, 2006/02/12, ASNMTAP CPAN module ASNMTAP::Asnmtap::Plugins::Mail and  ASNMTAP::Asnmtap::Plugins::Modem

Version 3.000.003, 2006/02/03, ASNMTAP CPAN module

Version 3.000.001 - 3.000.002, 2006/01/01 - 2006/01/08, ASNMTAP Package Object Oriented Perl

v0.15.1 - v0.15.19, 2004/02/05 - 2005/12/11

v0.14.1a - v0.14.2, 2004/01/01 - 2004/02/02


COPYRIGHT NOTICE
© Copyright 2003 Stanley.Hopcroft@IPAustralia.Gov.AU

'Nagios::WebTransact', v0.14.1, Stanley.Hopcroft@IPAustralia.Gov.AU

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

COPYRIGHT
© Copyright 2000-2006 by Alex Peeters [alex.peeters@citap.com]

'archive.pl'                              is based on 'Secure System Backup tool v1.3.2-03' written by Alex Peeters [alex.peeters@citap.com]
'rsync-mirror-distributed-<hostname>.sh'  is based on 'Secure System Backup tool v1.3.2-03' written by Alex Peeters [alex.peeters@citap.com]
'rsync-mirror-failover-<hostname>.sh'     is based on 'Secure System Backup tool v1.3.2-03' written by Alex Peeters [alex.peeters@citap.com]
'rsync-wrapper-distributed-<hostname>.sh' is based on 'Secure System Backup tool v1.3.2-03' written by Alex Peeters [alex.peeters@citap.com]
'rsync-wrapper-failover-<hostname>.sh'    is based on 'Secure System Backup tool v1.3.2-03' written by Alex Peeters [alex.peeters@citap.com]
'sshWrapperASNMTAP.pl'                    is based on 'Secure System Backup tool v1.3.2-03' written by Alex Peeters [alex.peeters@citap.com]

2000/12/09 - 2002/01/28, v1.3.2-01 - v1.3.2-03

2000/11/07 - 2000/12/02, v1.3.1-01 - v1.3.1-05

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

LICENCE

This ASNMTAP CPAN library and Plugin templates are free software; you can 
redistribute it and/or modify it under the same terms as Perl itself.

The other parts of ASNMTAP may be used and modified free of charge by anyone
so long as this copyright notice and the comments above remain intact. By 
using this code you agree to indemnify Alex Peeters from any liability that 
might arise from it's use.

Selling the code for this program without prior written consent is expressly 
forbidden. In other words, please ask first before you try and make money off 
of my program.

Obtain permission before redistributing this software over the Internet or
in any other medium. In all cases copyright and header must remain intact.

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

